{"version":3,"file":"js/113-legacy.3da059c7.js","mappings":"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","sources":["webpack://blog_vue/./src/components/content/ArticleSend.vue?8e9b","webpack://blog_vue/src/components/content/ArticleSend.vue","webpack://blog_vue/./src/components/content/ArticleSend.vue?613a","webpack://blog_vue/./src/components/content/ArticleSend.vue"],"sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"ArticleSend-container\"},[_c('el-breadcrumb',{attrs:{\"separator-class\":\"el-icon-arrow-right\"}},[_c('el-breadcrumb-item',{attrs:{\"to\":{ path: '/welcome' }}},[_vm._v(\"首页\")]),_c('el-breadcrumb-item',[_vm._v(\"文章管理\")]),_c('el-breadcrumb-item',[_vm._v(\"文章发布\")])],1),_c('el-card',[_c('el-form',{ref:\"sendformRef\",attrs:{\"model\":_vm.pubForm,\"label-width\":\"80px\",\"rules\":_vm.sendformRed}},[_c('el-form-item',{attrs:{\"label\":\"文章标题\",\"prop\":\"title\"}},[_c('el-input',{attrs:{\"placeholder\":\"请输入文章标题\"},model:{value:(_vm.pubForm.title),callback:function ($$v) {_vm.$set(_vm.pubForm, \"title\", $$v)},expression:\"pubForm.title\"}})],1),_c('el-form-item',{attrs:{\"label\":\"文章分类\",\"prop\":\"cate_id\"}},[_c('el-select',{attrs:{\"placeholder\":\"请选择分类\",\"clearable\":\"\"},model:{value:(_vm.pubForm.cate_id),callback:function ($$v) {_vm.$set(_vm.pubForm, \"cate_id\", $$v)},expression:\"pubForm.cate_id\"}},_vm._l((_vm.options),function(item){return _c('el-option',{key:item.Id,attrs:{\"label\":item.name,\"value\":item.Id}})}),1)],1),_c('el-form-item',{attrs:{\"label\":\"文章内容\"}},[_c('quill-editor',{ref:\"editorRef\",staticClass:\"editor\",model:{value:(_vm.pubForm.content),callback:function ($$v) {_vm.$set(_vm.pubForm, \"content\", $$v)},expression:\"pubForm.content\"}})],1),_c('el-form-item',{staticClass:\"img-item\",attrs:{\"label\":\"文章封面\",\"prop\":\"cover_img\"}},[(_vm.preview)?_c('img',{ref:\"imgRef\",staticClass:\"cover-img\",attrs:{\"src\":_vm.preview,\"alt\":\"\"}}):_c('img',{ref:\"imgRef\",staticClass:\"cover-img\",attrs:{\"src\":require(\"../../../src/assets/cover.jpg\"),\"alt\":\"\"}}),_c('br'),_c('input',{ref:\"iptFile\",staticStyle:{\"display\":\"none\"},attrs:{\"type\":\"file\",\"accept\":\"image/*\"},on:{\"change\":_vm.onCoverChange}}),_c('el-button',{attrs:{\"type\":\"text\"},on:{\"click\":function($event){return _vm.$refs.iptFile.click()}}},[_vm._v(\"+ 选择封面\")])],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.pubArt('已发布')}}},[_vm._v(\"发布\")]),_c('el-button',{attrs:{\"type\":\"info\"},on:{\"click\":function($event){return _vm.pubArt('草稿')}}},[_vm._v(\"存为草稿\")])],1)],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"ArticleSend-container\">\r\n    <!-- 面包屑 -->\r\n    <el-breadcrumb separator-class=\"el-icon-arrow-right\">\r\n      <el-breadcrumb-item :to=\"{ path: '/welcome' }\">首页</el-breadcrumb-item>\r\n      <el-breadcrumb-item>文章管理</el-breadcrumb-item>\r\n      <el-breadcrumb-item>文章发布</el-breadcrumb-item>\r\n    </el-breadcrumb>\r\n    <!-- 卡片 -->\r\n    <el-card>\r\n      <el-form :model=\"pubForm\" label-width=\"80px\" ref=\"sendformRef\" :rules=\"sendformRed\">\r\n        <el-form-item label=\"文章标题\" prop=\"title\">\r\n          <el-input placeholder=\"请输入文章标题\" v-model=\"pubForm.title\"></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"文章分类\" prop=\"cate_id\">\r\n          <el-select v-model=\"pubForm.cate_id\" placeholder=\"请选择分类\" clearable>\r\n            <el-option v-for=\"item in options\" :key=\"item.Id\" :label=\"item.name\" :value=\"item.Id\">\r\n            </el-option>\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"文章内容\">\r\n          <quill-editor ref=\"editorRef\" v-model=\"pubForm.content\" class=\"editor\"></quill-editor>\r\n        </el-form-item>\r\n        <el-form-item label=\"文章封面\" class=\"img-item\" prop=\"cover_img\">\r\n          <!-- 用来显示封面的图片 -->\r\n          <img v-if=\"preview\" :src=\"preview\" alt=\"\" class=\"cover-img\" ref=\"imgRef\" />\r\n          <img v-else src=\"../../../src/assets/cover.jpg\" alt=\"\" class=\"cover-img\" ref=\"imgRef\" />\r\n          <br />\r\n          <!-- 文件选择框，默认被隐藏 -->\r\n          <input @change=\"onCoverChange\" type=\"file\" style=\"display: none;\" accept=\"image/*\" ref=\"iptFile\" />\r\n          <!-- 选择封面的按钮 -->\r\n          <el-button type=\"text\" @click='$refs.iptFile.click()'>+ 选择封面</el-button>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-button @click=\"pubArt('已发布')\" type=\"primary\">发布</el-button>\r\n          <el-button @click=\"pubArt('草稿')\" type=\"info\">存为草稿</el-button>\r\n        </el-form-item>\r\n      </el-form>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data () {\r\n    return {\r\n      preview: '', // 做预览的 url\r\n      content: '',\r\n      options: [],\r\n      cate_id: '',\r\n      pubForm: {\r\n        title: '',\r\n        cate_id: '',\r\n        content: '',\r\n        cover_img: '', // 提交给服务器的 blob 二进制\r\n        state: ''\r\n      },\r\n      sendformRed: {\r\n        title: [\r\n          { required: true, message: '请输入文章标题', trigger: 'blur' },\r\n          { min: 1, max: 30, message: '文章标题的长度为1-30个字符', trigger: 'blur' }\r\n        ],\r\n        cate_id: [{ required: true, message: '请选择文章分类', trigger: 'blur' }],\r\n        cover_img: [{ required: true, message: '请选择文章封面', trigger: 'change' }]\r\n      }\r\n    }\r\n  },\r\n  created () {\r\n    this.getArticleCate()\r\n  },\r\n  methods: {\r\n    async getArticleCate () {\r\n      const { data: res } = await this.$http.get('/my/article/cates')\r\n      this.options = res.data\r\n    },\r\n    pubArt (state) {\r\n      // 将状态进行保存\r\n      this.pubForm.state = state\r\n      this.$refs.sendformRef.validate(async valid => {\r\n        if (!valid) return this.$message.error('请填写完整信息')\r\n        const fd = new FormData()\r\n        Object.keys(this.pubForm).forEach(k => fd.append(k, this.pubForm[k]))\r\n        const { data: res } = await this.$http.post('/my/article/add', fd, { headers: { 'Content-Type': 'multipart/form-data' } })\r\n        if (res.status !== 0) return this.$message.error('发布文章失败！')\r\n        if (this.pubForm.state === '已发布') {\r\n          this.$message.success('发布文章成功!')\r\n          console.log(this.pubForm)\r\n          // 清空图片\r\n          this.preview = ''\r\n          // 重置表单\r\n          this.$refs.sendformRef.resetFields()\r\n        } else {\r\n          this.$message.info('已存为草稿!')\r\n          // 清空图片\r\n          this.preview = ''\r\n          // 重置表单\r\n          this.$refs.sendformRef.resetFields()\r\n        }\r\n      })\r\n    },\r\n    //  图片发生变化时，监听事件\r\n    onCoverChange (e) {\r\n      //  获取用户选择的文件\r\n      const file = e.target.files[0]\r\n      console.log(file)\r\n      if (file) {\r\n        // 由于 img 的 src 只能设置 BASE64 或 URL\r\n        // 方案有两种: 转成 BASE64 或 URL\r\n        // FileReader --> BASE64\r\n        // A. 将文件转成 BASE64\r\n        // // 1. 创建对象\r\n        // const fr = new FileReader()\r\n        // // 2. 读文件\r\n        // fr.readAsDataURL(file)\r\n        // // 3. 获取结果\r\n        // fr.onload = e => {\r\n        //   // 4. 设置给 img 的 src\r\n        //   this.cover = e.target.result\r\n        // }\r\n        // BASE64 的缺点: 体积增大 33% 左右\r\n        // B. 将文件对象转成 URL\r\n        // 该方法是原生 WEBAPI 的方法, 作用是将文件对象转成 URL\r\n        // URL 的生命周期和当前窗口绑定\r\n        this.preview = URL.createObjectURL(file)\r\n        // file 对象就是 blob 的子类对象, 所以可以直接传递给后台\r\n        console.log(this.preview)\r\n        this.pubForm.cover_img = file\r\n      } else {\r\n        // 清除预览\r\n        this.preview = ''\r\n        // 清除用户选择的文件\r\n        this.pubForm.cover_img = ''\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style  scoped>\r\n.quill-editor {\r\n  height: 300px;\r\n}\r\n.avatar-uploader .el-upload {\r\n  border: 1px dashed #d9d9d9;\r\n  border-radius: 6px;\r\n  cursor: pointer;\r\n  position: relative;\r\n  overflow: hidden;\r\n}\r\n.avatar-uploader .el-upload:hover {\r\n  border-color: #409eff;\r\n}\r\n.avatar-uploader-icon {\r\n  font-size: 28px;\r\n  color: #8c939d;\r\n  width: 178px;\r\n  height: 178px;\r\n  line-height: 178px;\r\n  text-align: center;\r\n}\r\n.avatar {\r\n  width: 178px;\r\n  height: 178px;\r\n  display: block;\r\n}\r\n.img-item {\r\n  margin-top: 140px;\r\n}\r\n.cover-img {\r\n  width: 320px;\r\n  height: 200px;\r\n  object-fit: cover;\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ArticleSend.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40[0].rules[0].use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./ArticleSend.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ArticleSend.vue?vue&type=template&id=2da1a8e7&scoped=true&\"\nimport script from \"./ArticleSend.vue?vue&type=script&lang=js&\"\nexport * from \"./ArticleSend.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ArticleSend.vue?vue&type=style&index=0&id=2da1a8e7&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2da1a8e7\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","path","_v","ref","pubForm","sendformRed","model","value","callback","$$v","$set","expression","_l","item","key","Id","name","preview","staticStyle","on","onCoverChange","$event","$refs","iptFile","click","pubArt","staticRenderFns","data","content","options","cate_id","title","cover_img","state","required","message","trigger","min","max","created","getArticleCate","methods","res","sendformRef","validate","valid","fd","Object","headers","console","e","log","file","URL","createObjectURL","component"],"sourceRoot":""}